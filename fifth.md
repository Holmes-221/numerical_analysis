#### 实现拉格朗日插值法，牛顿插值法要求：

构造数据，实现格朗日插值法，牛顿插值法

验证隆格现象

说明牛顿插值的优点 阐述两者的误差，验证是否一致

我们用以下数据为例来研究Lagrange插值法和Newton插值法：

原函数$F(x) = - (71x^{3})/10000 + (11x^{2})/100 - (59x)/100 + 13/10$

选取插值节点：

  x   2     2.5   4
  --- ----- ----- ------
  y   0.5   0.4   0.25

###### Langrange插值法

插值公式为：

$$p_{n}\left( x \right) = \sum_{i = 0}^{n}{y_{i}L_{i}\left( x \right)},L_{i}\left( x \right) = \prod_{j = 0,j \neq i}^{n}\frac{x - x_{j}}{x_{i} - x_{j}}$$

$p_{n}(x)$为Lagrange插值多项式，$L_{i}(x)$为Lagrange插值基函数。
另外，我们记$\omega_{n}(x) = (x - x_{0})(x - x_{1})\ldots(x - x_{n})$

***插值余项定理： ***

***若f(x)在包含插值节点***$x_{0},x_{1},\ldots x_{n}$***得区间\[a,b\]上n+1次可微，则对任意的***$x \in \lbrack a,b\rbrack$***,存在与x有关的***$\xi$***,使得***
$r_{n}(x) = f(x) - p_{n}(x) = \frac{\omega_{n}(x)}{(n + 1)!}f^{(n + 1)}(\xi)$

带入上面的数据，可得Lagrange插值函数$p_{2}(x) = 0.05x^{2} - 0.425x + 1.15$，

由余项定理可估计出插值余项为：$|r_{2}(x)| \leq 0.67$,大致图像如下：

从图像中我们可以看出Lagrange插值在插值区间内与原函数非常接近，然而一旦远离插值区间，就会产生明显的误差，也在正如插值余项定理所叙述的那样，在包含插值节点的区间上，余项定理成立。

Lagrange插值多项式得优点是结构紧凑，多项式的系数由明确的意义。但如果插值节点发生改变，其基函数$L_{i}(x)$也会发生改变，从而整个多项式与原来的插值多项式有明显的不同，因此在实际的计算中非常不方便，即lagrange插值不具有承继性。

![](media/image1.emf){width="6.090908792650919in"
height="3.4402187226596674in"}

###### Newton插值法：

Newton插值公式：$p_{n}\left( x \right) = f\left( x_{0} \right) + f\left\lbrack x_{0},x_{1} \right\rbrack\left( x - x_{0} \right) + f\left\lbrack x_{0},x_{1},x_{2} \right\rbrack\left( x - x_{0} \right)\left( x - x_{1} \right) + ... + f\left\lbrack x_{0},x_{1},...,x_{n} \right\rbrack\left( x - x_{0} \right)\left( x - x_{1} \right)\cdots\left( x - x_{n - 1} \right)$

Newton插值公式的余项是:\
$R_{n}(x) = f\lbrack x,x_{0},x_{1},...,x_{n}\rbrack(x - x_{0})(x - x_{1})...(x - x_{n})$

***设f(x)在包含插值节点***$x_{0},x_{1},\ldots,x_{n}$***的区间\[a,b\]上n次可微，则介于插值节点之间存在一个***$\xi$***,***$\quad$***使得：***
$f\lbrack x_{0},x_{1},\ldots,x_{n}\rbrack = \frac{f^{n}(\xi)}{n!}$

  x     0阶差商   1阶差商   2阶差商
  ----- --------- --------- ---------
  2     0.5       -0.2      0.15
  2.5   0.4       0.1       
  4     0.25                

在本题中，可以得到插商表：

从差商表中可得到Newton插值多项式$\quad p_{n}(x) = 0.5 - 0.2(x - 2) + 0.15(x - 2)(x - 2.5)$,化简后为：

$$p_{2}(x) = 0.15x^{2} - 0.875x + 1.65$$

误差$r_{n}(x) \leq 2.7$\
其函数图像如下：

![](media/image2.emf){width="5.988194444444445in"
height="3.5804199475065617in"}

我们可以从函数图像观察到，在插值区间内Newton插值多项式与原函数拟合的非常好，但缺陷也非常明显，和Lagrange插值多项式一样，在插值区间外插值多项式和原函数的误差明显增大。尽管如此，Newton插值比Lagrange插值更方便。因为如果改变插值节点，Newton插值法并不需要像Lagrange插值法那样改变所有的插值基函数。

###### Runge现象 

从上面我们可以知道，插值多项式在插值区间内的拟合度非常好，那么想要增加插值多项式的精度，可以采用增加插值节点的方式。但这种做法虽能提在区间内多项式，但也存在这一种不可避免的缺陷。随着插值节点的增加，插值多项式的阶数也越来越高，会在两端发生激烈的振荡，这就是龙格(Runge)现象。

![](media/image3.emf){width="5.997916666666667in"
height="2.828472222222222in"}我们以$f(x) = \frac{1}{1 + 25x^{2}}$为例，对其采用不同插值数目的插值节点进行计算，结果如下图所示：

从图中我们可以清楚看到，但插值节点n的个数增大时，插值函数的效果变差；并且当n增大到一定程度时，在两端还会产生剧烈的震荡现象，从而产生很大的误差。

为克服插值函数的不稳定性和发散性，我们一般采用分段低次插值。低次是避免插值函数出现Runge现象；分段是为了让插值函数在较大的区间内能很好的代替原函数。
